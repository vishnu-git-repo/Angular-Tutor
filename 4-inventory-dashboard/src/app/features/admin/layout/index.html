<!-- Main Layout -->
<div class="flex min-h-screen bg-black">

  <!-- Desktop Sidebar (Hidden on Mobile) -->
  <div class="hidden md:block fixed left-0 top-0 h-screen bg-gray-900 text-white z-30 
              transition-all duration-300 ease-in-out overflow-hidden" [class.w-64]="sidebarExpanded()"
    [class.w-16]="!sidebarExpanded()" (mouseenter)="onSidebarHover()" (mouseleave)="onSidebarLeave()">

    <!-- Sidebar Header -->
    <div class="p-4 border-b border-gray-800 h-16 flex items-center">
      <div class="flex items-center gap-3 whitespace-nowrap">
        <i class="pi pi-apple text-xl shrink-0"></i>
        <span class="transition-opacity duration-300 overflow-hidden" [class.opacity-100]="sidebarExpanded()"
          [class.opacity-0]="!sidebarExpanded()" [class.w-0]="!sidebarExpanded()">
          Dashboard
        </span>
      </div>
    </div>

    <!-- Sidebar Menu -->
    <div class="p-4 space-y-2">
      <!-- Home -->
      <a routerLink="insight" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800 transition-colors">
        <i class="pi pi-home text-lg shrink-0"></i>
        <span class="transition-all duration-300 overflow-hidden whitespace-nowrap"
          [class.opacity-100]="sidebarExpanded()" [class.opacity-0]="!sidebarExpanded()"
          [class.w-0]="!sidebarExpanded()">
          Home
        </span>
      </a>

      <!-- Users -->
      <a routerLink="users" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800 transition-colors">
        <i class="pi pi-users text-lg shrink-0"></i>
        <span class="transition-all duration-300 overflow-hidden whitespace-nowrap"
          [class.opacity-100]="sidebarExpanded()" [class.opacity-0]="!sidebarExpanded()"
          [class.w-0]="!sidebarExpanded()">
          Users
        </span>
      </a>

      <!-- Equipments -->
      <a routerLink="equipments" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800 transition-colors">
        <i class="pi pi-cog text-lg shrink-0"></i>
        <span class="transition-all duration-300 overflow-hidden whitespace-nowrap"
          [class.opacity-100]="sidebarExpanded()" [class.opacity-0]="!sidebarExpanded()"
          [class.w-0]="!sidebarExpanded()">
          Equipments
        </span>
      </a>

      <a routerLink="borrows" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800 transition-colors">
        <i class="pi pi-receipt text-lg shrink-0"></i>
        <span class="transition-all duration-300 overflow-hidden whitespace-nowrap"
          [class.opacity-100]="sidebarExpanded()" [class.opacity-0]="!sidebarExpanded()"
          [class.w-0]="!sidebarExpanded()">
          Borrows
        </span>
      </a>

    </div>
  </div>

  <!-- Main Content Area -->
  <div class="flex-1 transition-all duration-300" [class.md:ml-16]="!sidebarExpanded()"
    [class.md:ml-64]="sidebarExpanded()">

    <!-- Top Navbar -->
    <div class="bg-white text-black shadow px-10 py-2 border-b">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <!-- Mobile Menu Button -->
          <button type="button" class="p-2 rounded-lg hover:bg-gray-100 md:hidden text-black"
            (click)="toggleMobileMenu()">
            <i class="pi pi-bars text-xl"></i>
          </button>

          <!-- Desktop Menu Button (Fixed - using method instead of arrow function) -->
          <!-- <button type="button"
                  class="p-2 rounded-lg hover:bg-gray-100 hidden md:block"
                  (click)="toggleSidebarExpanded()">
            <i class="pi pi-bars text-xl text-black"></i>
          </button> -->
          <p-avatar [label]="user().name.slice(0,1)" shape="circle"></p-avatar>
          <h1 class="ml-4 text-xl font-semibold text-black">Inventory</h1>
        </div>

        <!-- Logout -->
        <div
          class="w-10 h-10 rounded-full border border-gray-300 hover:border-red-500 bg-white hover:bg-red-50 flex items-center justify-center cursor-pointer transition-all duration-200 shadow-sm hover:shadow-md group relative"
          (click)="handleLogout()"
          pTooltip="Logout" 
          pTooltipPosition="bottom" 
          tooltipStyleClass="custom-tooltip"
        >
          <i class="pi pi-sign-out text-gray-600 group-hover:text-red-600 text-lg active:scale-90 transition-all duration-200"></i>
        </div>
      </div>
    </div>

    <!-- Page Content -->
    <div class="p-4 md:p-6">
      <router-outlet></router-outlet>
    </div>
  </div>
</div>

<!-- Mobile Drawer (Only shown on mobile) -->
<p-drawer [(visible)]="sidebarVisible" position="left" [modal]="true" styleClass="w-72">

  <div class="h-full bg-gray-900 text-white">
    <!-- Drawer Header -->
    <div class="p-4 border-b border-gray-800">
      <h2 class="text-xl font-bold flex items-center gap-2">
        <i class="pi pi-apple"></i>
        Dashboard
      </h2>
    </div>

    <!-- Drawer Menu -->
    <div class="p-4 space-y-2">
      <a routerLink="insight" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800" (click)="closeSidebar()">
        <i class="pi pi-home"></i>
        <span>Home</span>
      </a>

      <a routerLink="users" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800" (click)="closeSidebar()">
        <i class="pi pi-users"></i>
        <span>Users</span>
      </a>

      <a routerLink="equipments" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800"
        (click)="closeSidebar()">
        <i class="pi pi-cog"></i>
        <span>Equipments</span>
      </a>

      <a routerLink="borrows" class="flex items-center gap-3 p-3 rounded-lg hover:bg-gray-800" (click)="closeSidebar()">
        <i class="pi pi-receipt"></i>
        <span>Borrows</span>
      </a>

    </div>
  </div>
</p-drawer>